---
title: "PA1_template.Rmd"
output: html_document
---
## Introduction
Below is the peer assessment assignment 1 of the course "Reproducible Research".

## Reading the data

```{r, echo = TRUE}
library(plyr)

# Reads the data into the workspace
# colClass specify the respective data types of each column 
data <- read.csv("activity.csv", colClasses = c("numeric", "Date", "numeric"))

```

# The mean total of steps per day
The histogram below shows the number of steps travelled each day.

```{r, echo= TRUE}
# 1. Histogram of number of steps per day

datasum <- aggregate(x=list(steps=data$steps), by=list(Day=data$date), FUN=sum, na.rm=TRUE)

tot_steps <- sum(datasum$steps)/nrow(datasum) # = Number of steps per day

hist(datasum$steps, main = "Number Of Steps per Day", xlab = "Number Of Steps", ylab = "frequency")

# 2. Mean and median Number of steps per day

meansteps <- round(mean(datasum$steps, na.rm = T), digits = 2) # The round() converts the output to 2 decimal places

mediansteps <- round(median(datasum$steps, na.rm = T), digits = 2)

```


The mean number of steps travelled per day is `r meansteps` and the median number of steps is `r mediansteps`.

# Average Daily Pattern

Below is a series plot showing the average daily pattern.

```{r, echo = TRUE}
library(ggplot2)
data2 <- aggregate(x=list(steps=data$steps), by=list(interval=data$interval), FUN=mean, na.rm=TRUE)

p <- ggplot(data2, aes(x = interval)) +
geom_line(aes(y = steps), colour="blue") +
    ylab(label="Number Of Steps") +xlab("Intervals")
px <- p+ ggtitle("Average Number Of Steps Per Day")
px

maxsteps <- subset(data2, steps >= max(data2$steps, na.rm = T),select=c(steps,interval))
maxsteps # maximum number of steps
```

The maximum number of steps on average, corresponds to interval `r maxsteps$interval`.

# Imputing Missing values

```{r, echo = TRUE}
missingV <- sum(is.na(data))
mydata <- data
mydata[is.na(data)] <-  37 
# Histogram of number of steps per day

hist(mydata$steps, main = "Number Of Steps per Day", xlab = "Number Of Days", ylab = "Number Of Steps")

# Mean and median Number of steps per day

meansteps1 <- round(mean(mydata$steps), digits = 2) # The round() converts the output to 2 decimal places

mediansteps1 <- round(median(mydata$steps, na.rm = T), digits = 2)
```

- There are `r missingV` missing values in the data.
- The mean number of steps is `r meansteps1` and the median number of steps is `r mediansteps1`.
- There are no differences between the mean and median calculated in this step and those calculated earlier.